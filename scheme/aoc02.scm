(define input (list (list 29 13 26) (list 11 11 14) (list 27 2 5) (list 6 10 13) (list 15 19 10) (list 26 29 15) (list 8 23 6) (list 17 8 26) (list 20 28 3) (list 23 12 24) (list 11 17 3) (list 19 23 28) (list 25 2 25) (list 1 15 3) (list 25 14 4) (list 23 10 23) (list 29 19 7) (list 17 10 13) (list 26 30 4) (list 16 7 16) (list 7 5 27) (list 8 23 6) (list 2 20 2) (list 18 4 24) (list 30 2 26) (list 6 14 23) (list 10 23 9) (list 29 29 22) (list 1 21 14) (list 22 10 13) (list 10 12 10) (list 20 13 11) (list 12 2 14) (list 2 16 29) (list 27 18 26) (list 6 12 20) (list 18 17 8) (list 14 25 1) (list 30 15 22) (list 17 18 7) (list 28 23 24) (list 15 12 25) (list 14 7 20) (list 29 23 8) (list 24 5 22) (list 6 22 8) (list 1 15 26) (list 14 5 1) (list 24 28 28) (list 17 23 23) (list 4 15 7) (list 23 8 11) (list 6 15 1) (list 23 18 13) (list 17 1 26) (list 23 13 17) (list 2 18 8) (list 22 22 1) (list 10 22 6) (list 28 29 20) (list 22 21 25) (list 14 8 23) (list 12 30 14) (list 8 7 5) (list 3 30 15) (list 4 3 29) (list 25 18 3) (list 16 7 16) (list 4 3 8) (list 9 16 30) (list 20 28 3) (list 28 24 6) (list 4 18 2) (list 23 18 5) (list 22 4 30) (list 15 30 9) (list 7 12 12) (list 3 22 29) (list 12 1 9) (list 9 2 25) (list 17 11 10) (list 25 24 7) (list 7 27 26) (list 26 4 12) (list 29 2 26) (list 19 24 12) (list 23 23 3) (list 26 28 16) (list 18 4 16) (list 25 30 18) (list 29 19 19) (list 16 3 27) (list 29 25 29) (list 18 19 5) (list 14 21 30) (list 19 13 26) (list 19 10 15) (list 9 4 7) (list 18 6 6) (list 24 25 29) (list 9 12 27) (list 15 3 22) (list 30 17 21) (list 18 19 28) (list 9 11 12) (list 8 28 22) (list 11 3 4) (list 28 17 20) (list 24 18 15) (list 11 12 13) (list 6 19 24) (list 28 4 5) (list 28 22 23) (list 13 29 2) (list 9 16 15) (list 29 28 1) (list 10 18 30) (list 19 11 12) (list 26 28 25) (list 23 17 13) (list 25 1 21) (list 17 1 27) (list 17 27 28) (list 28 13 15) (list 14 13 25) (list 11 29 7) (list 22 29 5) (list 13 6 14) (list 23 18 13) (list 25 7 17) (list 18 9 20) (list 21 11 2) (list 28 11 13) (list 13 25 1) (list 19 29 25) (list 16 29 4) (list 10 21 10) (list 7 25 17) (list 5 9 3) (list 1 15 6) (list 8 27 29) (list 23 6 30) (list 22 22 29) (list 6 20 30) (list 26 25 29) (list 10 19 19) (list 20 30 9) (list 5 30 24) (list 17 10 27) (list 30 14 30) (list 8 17 4) (list 7 18 6) (list 3 5 4) (list 24 17 15) (list 14 20 17) (list 22 27 15) (list 18 14 15) (list 23 9 11) (list 21 16 29) (list 7 18 21) (list 9 3 29) (list 10 13 4) (list 2 30 4) (list 23 20 4) (list 8 22 21) (list 29 28 4) (list 13 16 25) (list 21 9 11) (list 7 26 26) (list 13 23 30) (list 19 7 10) (list 9 23 21) (list 21 9 17) (list 9 21 15) (list 20 29 22) (list 23 13 15) (list 19 25 2) (list 12 11 30) (list 20 21 6) (list 21 6 17) (list 24 26 9) (list 29 21 29) (list 29 26 16) (list 6 16 1) (list 2 12 6) (list 6 7 20) (list 7 2 22) (list 6 22 4) (list 13 11 27) (list 25 27 14) (list 11 8 6) (list 26 11 14) (list 30 3 29) (list 27 21 20) (list 15 16 26) (list 6 22 10) (list 11 9 25) (list 23 13 6) (list 13 9 3) (list 30 22 13) (list 29 23 14) (list 25 19 6) (list 7 29 11) (list 19 18 5) (list 29 25 13) (list 25 24 27) (list 1 9 12) (list 22 9 17) (list 14 12 28) (list 19 21 17) (list 13 25 17) (list 14 25 12) (list 4 14 30) (list 7 15 28) (list 3 6 25) (list 6 2 16) (list 15 19 11) (list 17 30 20) (list 20 23 7) (list 26 21 6) (list 26 29 24) (list 2 4 30) (list 4 22 18) (list 13 3 28) (list 27 6 21) (list 5 3 27) (list 12 7 11) (list 28 11 9) (list 12 9 2) (list 1 22 20) (list 15 13 28) (list 14 19 16) (list 28 20 3) (list 20 4 9) (list 26 7 26) (list 18 19 25) (list 7 1 13) (list 20 23 29) (list 27 26 8) (list 11 15 15) (list 10 21 23) (list 29 2 11) (list 21 28 20) (list 3 18 23) (list 26 17 17) (list 14 26 17) (list 20 7 17) (list 18 12 8) (list 4 8 8) (list 8 15 23) (list 24 29 5) (list 1 25 8) (list 1 28 17) (list 16 18 13) (list 29 24 22) (list 13 16 10) (list 14 7 16) (list 15 11 29) (list 12 15 19) (list 17 6 28) (list 4 3 9) (list 15 16 8) (list 29 27 11) (list 2 24 20) (list 4 21 3) (list 29 24 27) (list 18 22 22) (list 7 8 18) (list 20 7 8) (list 19 9 2) (list 20 17 2) (list 2 29 10) (list 19 25 1) (list 28 9 3) (list 29 27 20) (list 7 21 7) (list 10 4 22) (list 26 8 5) (list 26 14 1) (list 5 27 9) (list 2 18 3) (list 3 27 17) (list 30 17 23) (list 30 11 20) (list 4 6 7) (list 6 29 27) (list 30 16 20) (list 24 30 28) (list 19 20 26) (list 18 1 25) (list 26 12 12) (list 19 15 29) (list 16 21 24) (list 23 13 26) (list 25 16 10) (list 8 9 18) (list 24 14 1) (list 24 15 21) (list 19 9 14) (list 8 23 11) (list 22 2 16) (list 29 9 26) (list 3 16 25) (list 15 20 30) (list 3 11 12) (list 15 2 3) (list 13 7 4) (list 2 7 27) (list 9 26 11) (list 30 24 19) (list 28 17 21) (list 10 8 2) (list 11 15 26) (list 10 12 20) (list 24 24 27) (list 25 26 16) (list 13 4 20) (list 25 13 11) (list 12 22 3) (list 20 7 1) (list 12 18 6) (list 26 8 20) (list 14 2 7) (list 23 12 1) (list 26 24 24) (list 27 26 23) (list 26 17 5) (list 17 24 2) (list 26 5 6) (list 23 5 1) (list 5 18 30) (list 24 21 19) (list 5 28 11) (list 21 20 14) (list 25 4 22) (list 26 24 11) (list 7 5 8) (list 13 1 30) (list 5 1 6) (list 14 5 2) (list 8 11 7) (list 13 20 1) (list 17 30 14) (list 29 22 10) (list 12 26 3) (list 27 17 3) (list 26 27 4) (list 5 26 17) (list 22 11 19) (list 8 26 3) (list 24 19 22) (list 7 1 4) (list 6 27 30) (list 4 28 14) (list 16 14 18) (list 4 5 20) (list 19 25 4) (list 15 15 1) (list 10 14 14) (list 16 18 24) (list 21 27 15) (list 5 5 10) (list 1 7 13) (list 16 2 8) (list 13 15 11) (list 3 25 10) (list 20 29 8) (list 12 3 2) (list 10 13 12) (list 25 27 1) (list 11 30 19) (list 7 19 13) (list 27 6 18) (list 16 21 19) (list 21 29 5) (list 16 23 12) (list 29 19 15) (list 5 5 10) (list 27 15 1) (list 13 16 22) (list 29 19 5) (list 8 12 9) (list 3 18 5) (list 13 25 3) (list 5 9 21) (list 10 20 16) (list 9 9 11) (list 23 21 1) (list 22 2 15) (list 27 8 13) (list 23 7 3) (list 26 30 15) (list 29 15 16) (list 16 27 13) (list 2 18 9) (list 10 27 8) (list 20 9 25) (list 10 2 17) (list 16 13 13) (list 21 26 1) (list 27 26 24) (list 9 30 16) (list 19 17 28) (list 25 15 1) (list 10 26 6) (list 10 11 11) (list 5 26 25) (list 30 4 15) (list 9 8 23) (list 14 25 7) (list 8 28 8) (list 28 18 24) (list 4 4 25) (list 16 25 11) (list 17 27 8) (list 15 16 9) (list 24 13 21) (list 17 3 27) (list 27 5 26) (list 8 27 12) (list 29 2 8) (list 24 23 30) (list 1 30 21) (list 6 18 20) (list 13 14 12) (list 25 30 23) (list 24 6 24) (list 12 7 21) (list 11 6 8) (list 8 30 30) (list 26 3 12) (list 28 6 5) (list 18 7 1) (list 7 6 20) (list 14 16 18) (list 11 22 15) (list 4 20 10) (list 19 24 19) (list 8 24 11) (list 4 9 10) (list 6 6 22) (list 10 9 29) (list 1 5 28) (list 19 25 29) (list 20 30 3) (list 15 13 13) (list 9 9 24) (list 20 14 29) (list 26 24 13) (list 2 25 8) (list 10 26 2) (list 12 19 12) (list 18 6 20) (list 4 5 14) (list 26 27 10) (list 16 26 20) (list 3 21 15) (list 2 26 18) (list 14 11 17) (list 26 26 25) (list 10 1 11) (list 17 19 19) (list 27 28 26) (list 9 2 10) (list 19 30 15) (list 23 30 14) (list 15 3 20) (list 2 14 22) (list 21 18 8) (list 22 4 29) (list 19 6 29) (list 9 26 29) (list 16 10 9) (list 22 12 22) (list 13 28 14) (list 25 14 28) (list 28 3 30) (list 10 17 1) (list 10 27 22) (list 10 23 19) (list 14 25 9) (list 11 24 8) (list 30 25 10) (list 22 13 28) (list 2 7 6) (list 11 20 8) (list 9 22 14) (list 19 16 9) (list 11 24 4) (list 11 17 2) (list 6 4 10) (list 26 10 10) (list 12 14 5) (list 27 10 3) (list 15 3 6) (list 11 7 19) (list 22 10 12) (list 21 26 10) (list 13 20 3) (list 27 8 8) (list 1 24 23) (list 24 9 22) (list 23 17 23) (list 3 28 19) (list 2 20 28) (list 23 17 24) (list 26 1 4) (list 4 1 12) (list 5 6 16) (list 13 22 13) (list 25 21 21) (list 20 21 12) (list 9 24 25) (list 17 16 12) (list 12 28 9) (list 18 16 27) (list 29 12 2) (list 30 12 15) (list 24 11 10) (list 4 9 22) (list 4 24 5) (list 19 11 5) (list 6 25 6) (list 1 20 17) (list 22 8 21) (list 11 26 4) (list 16 19 3) (list 8 12 8) (list 13 2 18) (list 10 5 11) (list 8 12 17) (list 21 2 5) (list 26 17 26) (list 23 18 17) (list 28 11 14) (list 1 4 27) (list 29 5 28) (list 5 9 10) (list 5 7 25) (list 20 15 27) (list 15 11 17) (list 12 14 1) (list 29 14 4) (list 18 14 18) (list 14 25 24) (list 26 14 18) (list 13 8 11) (list 30 1 23) (list 3 4 12) (list 12 24 9) (list 8 6 16) (list 14 15 30) (list 12 30 8) (list 22 11 18) (list 16 30 28) (list 17 18 4) (list 13 14 23) (list 2 28 8) (list 3 28 30) (list 29 30 8) (list 4 6 26) (list 6 30 17) (list 11 30 30) (list 19 4 3) (list 12 15 20) (list 22 28 4) (list 26 30 2) (list 6 12 7) (list 1 10 5) (list 25 29 7) (list 17 9 18) (list 16 21 29) (list 21 14 7) (list 15 16 11) (list 26 6 15) (list 8 24 7) (list 2 20 4) (list 2 9 3) (list 19 8 13) (list 18 7 22) (list 27 14 17) (list 2 13 8) (list 18 15 26) (list 15 27 27) (list 18 11 15) (list 1 29 20) (list 21 12 11) (list 20 2 15) (list 28 23 9) (list 1 1 17) (list 7 23 9) (list 30 9 27) (list 9 16 18) (list 15 24 28) (list 30 11 18) (list 29 26 10) (list 9 5 25) (list 2 1 19) (list 14 3 14) (list 6 3 6) (list 30 15 20) (list 20 17 27) (list 28 10 9) (list 14 24 28) (list 17 11 6) (list 12 3 6) (list 8 8 15) (list 23 14 21) (list 11 21 7) (list 5 13 30) (list 4 29 25) (list 30 28 24) (list 18 4 9) (list 3 15 6) (list 13 9 19) (list 30 14 7) (list 7 9 9) (list 17 11 26) (list 24 26 13) (list 16 21 16) (list 27 17 25) (list 2 21 11) (list 9 11 27) (list 3 3 7) (list 13 8 14) (list 20 20 26) (list 13 29 22) (list 30 11 1) (list 7 10 19) (list 27 5 9) (list 23 17 15) (list 21 6 13) (list 24 15 16) (list 18 4 14) (list 18 16 6) (list 22 11 18) (list 14 2 5) (list 15 3 7) (list 10 20 29) (list 16 1 10) (list 30 23 1) (list 10 15 11) (list 17 14 5) (list 22 8 13) (list 7 11 28) (list 26 17 3) (list 2 23 2) (list 28 13 19) (list 18 12 28) (list 22 23 16) (list 14 12 1) (list 20 8 19) (list 17 19 13) (list 29 2 12) (list 2 26 27) (list 29 16 4) (list 13 8 18) (list 16 15 30) (list 23 16 2) (list 28 8 27) (list 21 8 23) (list 13 20 26) (list 19 6 17) (list 17 30 15) (list 7 4 30) (list 2 13 30) (list 18 7 19) (list 4 13 27) (list 8 6 5) (list 18 20 25) (list 2 3 30) (list 23 27 13) (list 22 30 4) (list 23 25 25) (list 23 16 19) (list 25 3 1) (list 5 6 15) (list 11 29 12) (list 25 24 7) (list 16 7 20) (list 20 3 2) (list 12 27 15) (list 16 10 12) (list 1 3 14) (list 22 1 26) (list 2 24 18) (list 11 29 16) (list 15 2 9) (list 10 1 24) (list 21 8 11) (list 30 11 23) (list 6 30 21) (list 13 27 29) (list 14 6 5) (list 18 29 19) (list 12 4 28) (list 29 3 14) (list 10 30 28) (list 5 7 15) (list 14 1 10) (list 9 25 14) (list 7 24 18) (list 28 17 21) (list 18 13 25) (list 26 15 1) (list 21 1 19) (list 12 16 21) (list 4 6 13) (list 7 15 26) (list 17 19 5) (list 12 28 2) (list 1 20 19) (list 27 7 5) (list 17 26 8) (list 12 15 19) (list 5 23 10) (list 8 2 8) (list 16 13 12) (list 14 27 1) (list 26 29 3) (list 24 16 14) (list 14 13 13) (list 7 22 23) (list 2 9 30) (list 4 27 8) (list 26 27 15) (list 23 1 6) (list 25 29 18) (list 5 18 1) (list 20 8 20) (list 5 10 25) (list 30 25 15) (list 7 22 25) (list 28 26 17) (list 29 4 1) (list 21 11 27) (list 20 9 8) (list 25 22 12) (list 2 11 11) (list 23 2 16) (list 23 27 20) (list 2 13 28) (list 27 2 24) (list 11 1 17) (list 12 4 27) (list 16 20 22) (list 30 12 10) (list 5 15 4) (list 5 2 27) (list 12 4 25) (list 1 16 4) (list 27 4 4) (list 21 16 3) (list 27 26 3) (list 24 6 6) (list 24 12 12) (list 20 20 25) (list 8 29 2) (list 21 4 5) (list 2 4 8) (list 4 13 19) (list 3 20 10) (list 12 15 16) (list 6 5 4) (list 12 16 20) (list 22 19 17) (list 8 17 22) (list 25 16 15) (list 7 1 19) (list 10 1 7) (list 23 23 5) (list 28 6 12) (list 2 25 12) (list 10 27 12) (list 24 27 19) (list 14 14 20) (list 4 1 5) (list 16 27 29) (list 20 20 24) (list 28 24 30) (list 6 15 15) (list 9 15 30) (list 23 26 3) (list 17 24 21) (list 22 25 25) (list 18 29 10) (list 20 25 1) (list 24 11 16) (list 20 7 21) (list 20 7 9) (list 7 26 2) (list 5 18 1) (list 16 26 28) (list 4 10 18) (list 27 30 21) (list 26 9 9) (list 8 16 14) (list 6 27 8) (list 28 9 20) (list 13 13 4) (list 9 18 16) (list 18 15 18) (list 22 19 14) (list 14 10 17) (list 25 29 11) (list 1 18 19) (list 8 11 26) (list 18 6 14) (list 30 24 13) (list 27 1 27) (list 15 9 3) (list 2 29 17) (list 2 26 21) (list 22 9 9) (list 20 20 20) (list 22 28 2) (list 26 5 16) (list 11 3 14) (list 21 16 16) (list 18 26 7) (list 18 30 6) (list 7 11 12) (list 15 10 2) (list 27 2 16) (list 27 30 24) (list 28 14 24) (list 7 4 8) (list 6 28 15) (list 13 19 1) (list 22 26 30) (list 7 30 24) (list 2 17 21) (list 19 26 2) (list 19 24 15) (list 14 23 2) (list 21 27 15) (list 30 15 14) (list 21 29 5) (list 23 30 2) (list 4 1 2) (list 15 5 13) (list 21 2 30) (list 20 7 16) (list 1 21 25) (list 2 25 1) (list 12 29 5) (list 28 13 16) (list 26 3 12) (list 29 20 23) (list 28 12 20) (list 4 30 8) (list 16 15 16) (list 6 16 29) (list 2 28 13) (list 24 25 2) (list 26 15 22) (list 17 20 11) (list 18 12 7) (list 19 1 18) (list 8 27 13) (list 22 16 8) (list 19 26 17) (list 13 11 10) (list 22 12 3) (list 13 12 14) (list 29 17 9) (list 6 14 10) (list 14 20 10) (list 8 26 9) (list 25 13 22) (list 3 30 25) (list 14 28 1) (list 30 29 12) (list 3 17 15) (list 3 24 14) (list 28 24 22) (list 16 6 1) (list 20 25 14) (list 17 17 13) (list 6 19 27) (list 10 15 20) (list 8 23 20) (list 7 29 21) (list 18 9 25) (list 10 5 22) (list 2 27 27) (list 16 18 30) (list 15 5 12) (list 26 29 29) (list 28 11 10) (list 9 29 28) (list 24 15 23) (list 26 9 10) (list 5 1 25) (list 22 27 16) (list 7 29 3) (list 1 3 5) (list 8 7 29) (list 19 21 11) (list 28 13 30) (list 17 16 20) (list 5 10 25) (list 9 14 15) (list 15 14 23) (list 16 4 17) (list 21 8 2) (list 9 9 8) (list 22 22 4) (list 10 2 27) (list 12 19 10) (list 15 29 4) (list 22 14 7) (list 29 18 5) (list 1 7 27) (list 24 1 15) (list 23 23 26) (list 12 17 23) (list 26 10 24) (list 8 22 2) (list 8 1 10) (list 22 19 12) (list 2 23 13) (list 11 27 25) (list 26 15 27) (list 27 7 21) (list 18 9 6) (list 22 21 22) (list 7 12 26) (list 23 21 13) (list 14 3 8) (list 5 9 28) (list 29 29 15) (list 27 25 23) (list 12 2 24) (list 8 2 20) (list 29 19 4) (list 12 24 29) (list 2 27 28) (list 14 20 9) (list 28 6 25) (list 18 29 8) (list 19 11 30) (list 15 11 23) (list 18 7 7) (list 14 20 14) (list 26 18 22) (list 27 25 13) (list 12 10 30) (list 30 2 7) (list 28 10 1) (list 18 10 30) (list 22 11 5) (list 22 16 3) (list 25 15 9) (list 5 10 24) (list 4 28 8) (list 19 24 18) (list 3 4 25) (list 14 4 30) (list 11 26 3) (list 12 12 12) (list 26 7 24) (list 3 2 14) (list 1 27 7) (list 2 2 13) (list 3 26 26) (list 12 4 11) (list 12 17 20) (list 4 19 30) (list 5 18 10) (list 17 6 18) (list 19 30 20) (list 11 2 17) (list 30 13 19) (list 22 23 7) (list 17 28 2) (list 5 17 30) (list 7 11 4) (list 21 26 18) (list 15 28 4) (list 5 6 27) (list 12 6 16) (list 9 17 12) (list 27 20 5) (list 14 5 20) (list 27 14 6) (list 2 14 21) (list 4 28 30) (list 24 5 1) (list 19 29 29) (list 11 23 1) (list 8 16 21) (list 3 17 19) (list 10 13 5) (list 20 21 16) (list 23 3 6) (list 27 26 11) (list 3 2 22) (list 14 3 5) (list 10 9 8)))

(define (order l)
  (sort l (lambda (x y) (< x y))))

(define (compute-cube-wrapping-paper cube)
  (let ((sorted-cube (order cube)))
    (let ((a (list-ref sorted-cube 0))
          (b (list-ref sorted-cube 1))
          (c (list-ref sorted-cube 2)))
      (+ (* 2 a b) (* 2 a c) (* 2 b c) (* a b)))))

(define (solve-1 input)
  (define (compute-all-wrapping-paper cube-list)
    (if (= (length cube-list) 0)
      0
      (+ (compute-cube-wrapping-paper (car cube-list)) (compute-all-wrapping-paper (cdr cube-list)))
    ))
  (compute-all-wrapping-paper input))

(define (compute-cube-ribon cube)
  (let ((sorted-cube (order cube)))
    (let ((a (list-ref sorted-cube 0))
          (b (list-ref sorted-cube 1))
          (c (list-ref sorted-cube 2)))
      (+ a a b b (* a b c)))))

(define (solve-2 input)
  (define (compute-all-ribon cube-list)
    (if (= (length cube-list) 0)
      0
      (+ (compute-cube-ribon (car cube-list)) (compute-all-ribon (cdr cube-list)))
    ))
  (compute-all-ribon input))

(and
  (= (compute-cube-wrapping-paper (list 2 3 4)) 58)
  (= (compute-cube-wrapping-paper (list 1 1 10)) 43))

(solve-1 input)

(and
  (= (compute-cube-ribon (list 2 3 4)) 34)
  (= (compute-cube-ribon (list 1 1 10)) 14))

(solve-2 input)
